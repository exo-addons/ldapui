<?xml version="1.0" encoding="UTF-8"?>
<jboss-identity xmlns="urn:picketlink:idm:config:v1_0_0_ga" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:picketlink:idm:config:v1_0_0_ga identity-config.xsd">
	<realms>
		<realm>
			<id>idm_realm</id>
			<repository-id-ref>PortalRepository</repository-id-ref>
			<identity-type-mappings>
				<user-mapping>USER</user-mapping>
			</identity-type-mappings>
			<options>
				<option>
					<name>cache.providerRegistryName</name>
					<value>apiCacheProvider</value>
				</option>
				<option>
					<name>credentialEncoder.class</name>
					<value>org.picketlink.idm.impl.credential.HashingEncoder</value>
				</option>
				<option>
					<name>credentialEncoder.hashAlgorithm</name>
					<value>MD5</value>
				</option>
			</options>
		</realm>
	</realms>
	<repositories>
		<repository>
			<id>PortalRepository</id>
			<class>org.picketlink.idm.impl.repository.FallbackIdentityStoreRepository</class>
			<external-config />
			<default-identity-store-id>HibernateStore</default-identity-store-id>
			<default-attribute-store-id>HibernateStore</default-attribute-store-id>
			<identity-store-mappings>
				<identity-store-mapping>
					<identity-store-id>PortalLDAPStore</identity-store-id>
					<identity-object-types>
						<identity-object-type>USER</identity-object-type>
						<identity-object-type>ldap_groups</identity-object-type>
					</identity-object-types>
				</identity-store-mapping>
			</identity-store-mappings>
			<options>
				<option>
					<name>allowNotDefinedAttributes</name>
					<value>true</value>
				</option>
			</options>
		</repository>
		<repository>
			<id>DefaultPortalRepository</id>
			<class>org.picketlink.idm.impl.repository.WrapperIdentityStoreRepository</class>
			<external-config />
			<default-identity-store-id>HibernateStore</default-identity-store-id>
			<default-attribute-store-id>HibernateStore</default-attribute-store-id>
		</repository>
	</repositories>
	<stores>
		<attribute-stores />
		<identity-stores>
			<identity-store>
				<id>HibernateStore</id>
				<class>org.picketlink.idm.impl.store.hibernate.HibernateIdentityStoreImpl</class>
				<external-config />
				<supported-relationship-types>
					<relationship-type>JBOSS_IDENTITY_MEMBERSHIP</relationship-type>
					<relationship-type>JBOSS_IDENTITY_ROLE</relationship-type>
				</supported-relationship-types>
				<supported-identity-object-types>
					<identity-object-type>
						<name>USER</name>
						<relationships />
						<credentials>
							<credential-type>PASSWORD</credential-type>
						</credentials>
						<attributes />
						<options />
					</identity-object-type>
				</supported-identity-object-types>
				<options>
					<option>
						<name>hibernateSessionFactoryRegistryName</name>
						<value>hibernateSessionFactory</value>
					</option>
					<option>
						<name>populateRelationshipTypes</name>
						<value>true</value>
					</option>
					<option>
						<name>populateIdentityObjectTypes</name>
						<value>true</value>
					</option>
					<option>
						<name>allowNotDefinedIdentityObjectTypes</name>
						<value>true</value>
					</option>
					<option>
						<name>allowNotDefinedAttributes</name>
						<value>true</value>
					</option>
					<option>
						<name>allowNotCaseSensitiveSearch</name>
						<value>true</value>
					</option>
					<option>
						<name>isRealmAware</name>
						<value>true</value>
					</option>
					<option>
						<name>lazyStartOfHibernateTransaction</name>
						<value>true</value>
					</option>
				</options>
			</identity-store>
			<identity-store>
				<id>PortalLDAPStore</id>
				<class>org.picketlink.idm.impl.store.ldap.LDAPIdentityStoreImpl</class>
				<external-config />
				<supported-relationship-types>
					<relationship-type>JBOSS_IDENTITY_MEMBERSHIP</relationship-type>
				</supported-relationship-types>
				<supported-identity-object-types>
					<identity-object-type>
						<name>USER</name>
						<relationships />
						<credentials>
							<credential-type>PASSWORD</credential-type>
						</credentials>
						<attributes>
							<attribute>
								<name>firstName</name>
								<mapping>${ldap.users.firstName}</mapping>
								<type>text</type>
								<isRequired>false</isRequired>
								<isMultivalued>false</isMultivalued>
								<isReadOnly>false</isReadOnly>
							</attribute>
							<attribute>
								<name>lastName</name>
								<mapping>${ldap.users.lastName}</mapping>
								<type>text</type>
								<isRequired>false</isRequired>
								<isMultivalued>false</isMultivalued>
								<isReadOnly>false</isReadOnly>
							</attribute>
							<attribute>
								<name>email</name>
								<mapping>${ldap.users.email}</mapping>
								<type>text</type>
								<isRequired>false</isRequired>
								<isMultivalued>false</isMultivalued>
								<isReadOnly>false</isReadOnly>
								<isUnique>true</isUnique>
							</attribute>
						</attributes>
						<options>
							<option>
								<name>idAttributeName</name>
								<value>${ldap.users.idAttributeName}</value>
							</option>
							<option>
								<name>entrySearchFilter</name>
								<value>${ldap.users.entrySearchFilter}</value>
							</option>
							<option>
								<name>passwordAttributeName</name>
								<value>${ldap.users.passwordAttributeName}</value>
							</option>
							<option>
								<name>ctxDNs</name>
								<value>${ldap.users.ctxDNs}</value>
							</option>
							<option>
								<name>searchTimeLimit</name>
								<value>10000</value>
							</option>
							<option>
								<name>createMissingContexts</name>
								<value>true</value>
							</option>
							<option>
								<name>sortExtensionSupported</name>
								<value>false</value>
							</option>
							<option>
								<name>customJNDIConnectionParameters</name>
								<value>com.sun.jndi.ldap.connect.pool=true</value>
							</option>
							<option>
								<name>customSystemProperties</name>
								<value>com.sun.jndi.ldap.connect.pool.maxsize=300000</value>
								<value>com.sun.jndi.ldap.connect.pool.protocol=plain ssl</value>
							</option>
							<option>
								<name>cache.providerRegistryName</name>
								<value>storeCacheProvider</value>
							</option>
							<option>
								<name>allowNotCaseSensitiveSearch</name>
								<value>true</value>
							</option>
						</options>
					</identity-object-type>
					<identity-object-type>
						<name>ldap_groups</name>
						<relationships>
							<relationship>
								<relationship-type-ref>JBOSS_IDENTITY_MEMBERSHIP</relationship-type-ref>
								<identity-object-type-ref>USER</identity-object-type-ref>
							</relationship>
							<relationship>
								<relationship-type-ref>JBOSS_IDENTITY_MEMBERSHIP</relationship-type-ref>
								<identity-object-type-ref>ldap_groups</identity-object-type-ref>
							</relationship>
						</relationships>
						<credentials />
						<attributes />
						<options>
							<option>
								<name>idAttributeName</name>
								<value>${ldap.groups.idAttributeName}</value>
							</option>
							<option>
								<name>ctxDNs</name>
								<value>${ldap.groups.ctxDNs}</value>
							</option>
							<option>
								<name>entrySearchFilter</name>
								<value>${ldap.groups.entrySearchFilter}</value>
							</option>
							<option>
								<name>allowCreateEntry</name>
								<value>true</value>
							</option>
							<option>
								<name>parentMembershipAttributeName</name>
								<value>member</value>
							</option>
							<option>
								<name>isParentMembershipAttributeDN</name>
								<value>true</value>
							</option>
							<option>
								<name>allowEmptyMemberships</name>
								<value>true</value>
							</option>
							<option>
								<name>createEntryAttributeValues</name>
								<value>objectClass=top</value>
								<value>objectClass=groupOfNames</value>
							</option>
						</options>
					</identity-object-type>
				</supported-identity-object-types>
				<options>
					<option>
						<name>providerURL</name>
						<value>${ldap.providerURL}</value>
					</option>
					<option>
						<name>adminDN</name>
						<value>${ldap.adminDN}</value>
					</option>
					<option>
						<name>adminPassword</name>
						<value>${ldap.adminPassword}</value>
					</option>
					<option>
						<name>searchTimeLimit</name>
						<value>10000</value>
					</option>
					<option>
						<name>createMissingContexts</name>
						<value>false</value>
					</option>
					<option>
						<name>sortExtensionSupported</name>
						<value>false</value>
					</option>
					<option>
						<name>customJNDIConnectionParameters</name>
						<value>com.sun.jndi.ldap.connect.pool=true</value>
					</option>
					<option>
						<name>customSystemProperties</name>
						<value>com.sun.jndi.ldap.connect.pool.maxsize=300000</value>
						<value>com.sun.jndi.ldap.connect.pool.protocol=plain ssl</value>
					</option>
					<option>
						<name>cache.providerRegistryName</name>
						<value>storeCacheProvider</value>
					</option>
					<option>
						<name>allowNotCaseSensitiveSearch</name>
						<value>true</value>
					</option>
				</options>
			</identity-store>
		</identity-stores>
	</stores>
	<options>
		<option>
			<name>defaultTemplate</name>
			<value>idm_realm</value>
		</option>
	</options>
</jboss-identity>